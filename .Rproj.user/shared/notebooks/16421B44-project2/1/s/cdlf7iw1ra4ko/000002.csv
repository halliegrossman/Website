"0","library(tidyverse)"
"0","#install.packages(""lmtest"")"
"0","library(lmtest)"
"0","#install.packages(""sandwich"")"
"0","library(sandwich)"
"0","#model"
"0","fit5 <- glm(Survive ~ Age + SysBP, data = ICU, family = ""binomial"")"
"0","summary(fit5)"
"1","
Call:
"
"1",""
"1","glm(formula = Survive ~ Age + SysBP, family = ""binomial"", data = ICU)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","    Min  "
"1","     1Q  "
"1"," Median  "
"1","     3Q  "
"1","    Max  "
"1","
"
"1","-2.7828  "
"1"," 0.3702  "
"1"," 0.5361  "
"1"," 0.7084  "
"1"," 1.1376  "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","
(Intercept)"
"1","  0.962471"
"1","   1.000272"
"1","   0.962"
"1","  0.33594"
"1","
Age        "
"1"," -0.028407"
"1","   0.010774"
"1","  -2.637"
"1","  0.00838"
"1","
SysBP      "
"1","  0.016831"
"1","   0.005859"
"1","   2.873"
"1","  0.00407"
"1","
"
"1","           "
"1","   "
"1","
(Intercept)"
"1","   "
"1","
Age        "
"1"," **"
"1","
SysBP      "
"1"," **"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","
"
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 200.16  on 199  degrees of freedom
"
"1",""
"1","Residual deviance: 183.26  on 197  degrees of freedom
"
"1","AIC: "
"1",""
"1","189.26"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","4"
"1",""
"1","
"
"1","
"
"0","exp(coef(fit5))"
"1","(Intercept) "
"1","        Age "
"1","      SysBP "
"1","
"
"1","   2.618157 "
"1","   0.971993 "
"1","   1.016974 "
"1","
"
"0","#predicted probs"
"0","probs<-predict(fit5, type=""response"")"
"0","#confusion matrix"
"0","table(predict=as.numeric(probs>.5),truth=ICU$Survive)%>%addmargins"
"1","       truth
"
"1","predict"
"1","   0"
"1","   1"
"1"," Sum"
"1","
    0  "
"1","   3"
"1","   0"
"1","   3"
"1","
    1  "
"1","  37"
"1"," 160"
"1"," 197"
"1","
    Sum"
"1","  40"
"1"," 160"
"1"," 200"
"1","
"
"0","#sensitivity = 1"
"0","160/160"
"1","[1]"
"1"," 1"
"1","
"
"0","#specificity = 0.075"
"0","3/40"
"1","[1]"
"1"," 0.075"
"1","
"
"0","#precision = 0.8128"
"0","160/197"
"1","[1]"
"1"," 0.8121827"
"1","
"
"0","#accuracy = 0.815"
"0","(3+160)/200"
"1","[1]"
"1"," 0.815"
"1","
"
"0","#DENSITY plot"
"0","ICU$logit<-predict(fit5,type=""link"") #get log-odds for everyone"
"0","logit<-function(p)log(odds(p))"
"0","ICU %>% ggplot() + geom_density(aes(logit,color=Outcome,fill=Outcome), alpha=.4)+"
"0","  theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab(""logit (log-odds)"")+"
"0","  geom_rug(aes(logit,color=Outcome)) "
